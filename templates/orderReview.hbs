<div class="marketplace-filter">
    <h1>{{localize "SR5.Marketplace.OrderReview"}}</h1>
</div>

<div class="grid">
    <!-- Section for Order Review description -->
    <div class="grid-item">
        <h2>{{localize "SR5.Marketplace.OrderReview"}}</h2>
        <p>{{localize "SR5.Marketplace.OrderReviewText"}}</p>
    </div>
    
    <!-- Section for reviewing items in the order -->
    <div class="grid-item">
        <h3>{{localize "SR5.Marketplace.OrderReviewItems"}}</h3>
        <div id="order-review-items" class="order-review-grid" data-flag-id="{{flagId}}">
            {{#each items}}
            <div class="order-review-item">
                <div class="item-details">
                    <span class="item-name">{{this.name}}</span>
                    <img class="item-image" src="{{this.image}}" alt="{{this.name}}">
                </div>

                <!-- Render the rating dropdown if the item has a rating -->
                <div class="item-rating-section">
                    {{#if this.selectedRating}}
                    <label for="item-rating-{{this.id}}" class="rating-label">{{localize "SR5.Marketplace.Rating"}}:</label>
                    <select class="order-review-rating" data-item-id="{{this.id}}" data-flag-id="{{../flagId}}" id="item-rating-{{this.id}}">
                        {{#range 1 13}}
                        <option value="{{this}}" {{#ifeq this ../selectedRating}}selected{{/ifeq}}>{{this}}</option>
                        {{/range}}
                    </select>
                    {{/if}}
                </div>

                <!-- Show the cost of the item using the helper -->
                <div class="item-cost-section">
                    <span class="item-cost">{{this.system.technology.cost}} ¥</span>
                </div>

                <!-- Show the availability of the item using the helper -->
                <div class="item-availability-section">
                    <span class="item-availability">{{this.system.technology.availability}}</span>
                </div>

                <!-- Remove button for each item -->
                <div class="item-remove-section">
                    <button class="remove-item" data-item-id="{{this.id}}">
                        <i class="fas fa-trash"></i> {{localize "SR5.Marketplace.RemoveItem"}}
                    </button>
                </div>
            </div>
            {{/each}}
        </div>

        <!-- Section for displaying total cost and availability -->
        <div class="order-review-summary">
            <p><strong>{{localize "SR5.Marketplace.Total"}} {{localize "SR5.Marketplace.system.technology.Cost"}}: <span id="order-review-total-cost">{{totalCost}}</span> ¥</strong></p>
            <p><strong>{{localize "SR5.Marketplace.TotalAvailability"}}: <span id="order-review-total-availability">{{totalAvailability}}</span></strong></p>
        </div>
    </div>
    
    <!-- Section for confirm/cancel buttons -->
    <div class="grid-item">
        <button id="send-request-button" class="send-request-button">
            {{localize 'SR5.Marketplace.SendRequest'}}
        </button>
        <button id="cancel-request-button" class="send-request-button cancel">
            {{localize 'SR5.Marketplace.CancelRequest'}}
        </button>
    </div>
</div>